<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>

//Callback
        // function loadScript(src, callback) {
        //     let script = document.createElement('script');
        //     script.src = src;

        //     script.onload = () => callback(null, script);
        //     script.onerror = () => callback(new Error("script not loaded"));
        //     document.head.append(script);
        // }

        // loadScript('./script1.js', ()=> {
        //     setTimeout(() => {
        //         console.log("loaded 1");
        //     }, 2000);

        //     loadScript('./script2.js', () => {
        //         setTimeout(() => {
        //             console.log("loaded 2")
        //         }, 2000)

        //         loadScript('./script3.js', () => {
        //             setTimeout(() => {
        //                 console.log("loaded 2")
        //             }, 2000)
        //         })
        //     })
        // })
        
        // loadScript('./script1.js', step1);

        // function step1(error, script) {
        //     if (error) {
        //         console.log(error.message + " in step 1");
        //     } else {
        //         loadScript('./script2.js', step2);
        //     }
        // }

        // function step2(error, script) {
        //     if (error) {
        //         console.log(error.message + " in step 2");
        //     } else {
        //         loadScript('./script3.js', step3);
        //     }
        // }

        // function step3(error, script) {
        //     if (error) {
        //         console.log(error.message + " in step 3");
        //     } else {
        //         console.log("done")
        //     }
        // }

//Promise

        // let promise = new Promise(function(resolve, reject) {
        //     setTimeout(() => {
        //         resolve("Its Done");
        //         reject("failed"); //ignored
        //         resolve("Not failed"); //ignored
        //     })
        // })

        // promise.then(data => {
        //     console.log(data);
        // })

        // promise.then(data => {
        //     console.log(data);
        // }, err => {
        //         console.log(err)
        // })

        // promise.finally(() => {
        //     console.log("cleaned");
        //     // return  "hoo";
        //     throw new Error("Holu hi");
        // })
        
        // promise.catch(err => {
        //     console.log(err);
        // })

//loadScript by promises

        function loadScript(src) {
            return new Promise(function(resolve, reject) {
                let script = document.createElement('script');
                script.src = src;

                script.onload = () => resolve(script);
                script.onerror = () => reject(new Error("script load error for "+src));

                document.head.append(script);
            })
        }

        let promise = loadScript('./script1.js');
        promise.then(() => {
            console.log("script 1 loaded");
            return loadScript('./script2.js')
        })
        .then(() => {
            console.log("script 2 loaded");
            return loadScript('./script3.js')
        })
        .then(() => {
            console.log("script 3 loaded")
        })
        .catch(err => {
            console.error(err.message);
        })
    </script>
</body>
</html>