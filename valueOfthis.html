<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <button id="btn1">click 1</button>
    <button id="btn2">click 2</button>

    <script>
        // Value of 'this' practice

        // Inside a regular function non strict mode
        // Here value will depend on how function is called not on where fucntion is defined

          // in global

          function inGlobal() {
              console.log(this);
            }

            // inGlobal();

          // Inside an object
            var name1 = "Outside"

            let obj1 = {
              name : "Inside",
              show : function() {
                console.log(this);
              }
            }

            // obj1.show()

          // Inside nested function

            function first() {
              function second() {
                console.log(this);
              }

              second()
            }

            // first()

            //inside nested but inside an object

            let obj2 = {
              name : "Inside",
              first : function() {
                function second() {
                  console.log(this);
                }

                second();
              }
            }

            // obj2.first();

            //when fucntion assigned to a variable

            let obj3 = {
                name : "insode",
                first : function() {
                    console.log(this);
                }
            }

            let firstCall = obj3.first;
            // firstCall(); // will be window as now it is a standalone fucntion and called as normal function.

            // When Explicit binding no rules will work

            function explicit() {
                console.log(this);
            }

            // explicit.call({name : "call"});
            // explicit.apply([{name : "apply"}, "hi"]);

            //In  addEventListener

            document.getElementById("btn1").addEventListener("click", function() {
              console.log(this); // button as function will be called on the element object
            })

            // AddEventListner when binded explicitly

            document.getElementById("btn1").addEventListener("click", function() {
              console.log(this); // Window as we have explicitly binded
            }.bind(window));

        // Inside Arrow function
         // Arrow function doesnt have this keyword them inherit them from there lexical scope

          // In global space

            let arrow = () => {
              console.log(this);
            }

            // arrow(); // window
         
          // Inside a fucntion

            function first() {
              let arrow = () => {
                console.log(this);
              }

              arrow()
            }

            // first(); //global

          // Inside an object

            let obj4 = {
              first : () => {
                console.log(this);
              }
            }

            // obj4.first(); // global

          // Inside a fucntion but functon is binded

            function second() {
              let arrow = () => {
                console.log(this);
              }

              arrow();
            }

            // second.call({name : "outside"}); //object

          // Inside a function which is inside an object
            
            let obj5 = {
              name : "obj5",
              outside : function() {
                let arrow = () => {
                  console.log(this.name);
                }

                arrow();
              }
            }

            // obj5.outside(); // Obj5

          // Assigning to a variable

          let obj6 = {
              name1 : "obj6",
              outside : function() {
                let arrow = () => {
                  console.log(this.name1);
                }

                arrow();
              }
            }

            let returnedFunction = obj6.outside;
            // returnedFunction(); // Outside

          //In addEventListener

          // document.getElementById("btn1").addEventListener("click", () => {
          //     console.log(this); // window as function will be called in the global scope
          // })

          // Arrow function itself returned to an variable

            let obj7 = {
              name : "Shivendra",
              first : function() {
                let arrow = () => {
                  console.log(this)
                }

                return arrow;
              }
            }

            let arrowOut = obj7.first();
            // arrowOut(); // Though we have taken it outside but it is defiend inside the function so this will be the object.

            //Arrow function given from outside

            obj7.second = () => {
              console.log(this);
            }

            // obj7.second(); // Window because function is defined outside

          
          //this inside the class

             //Inside class

             class Action {
              constructor(name) {
                this.name = name;
              }

              method1() {
                console.log(this);
              }
            } 

            let object1 = new Action("object 1");
            let object4 = new Action("Object 4")
            object1.method1(); // object1
            object4.method1(); // object4

             //inside a class with arrow function
              // Inside a class this will always point to the object So regular fucntion will give this as object as they are called on the object, and arrow fucntions will also give this = object as in class this is always object.

              class New {
                constructor() {
                  console.log(this);
                }

                show() {
                  console.log(this);
                }

                show2 = () => {
                  console.log(this);
                }
    
              }
              // object2 = new New(); // New 'New' is representing the object2
              // object2.show(); // New
              // object2.show2(); // New

              // AddEventListner inside the class

              class New2 {
                constructor() {
                  // document.getElementById('btn1').addEventListener("click", function() {
                  //   console.log(this); // button
                  // })
                }

                attach() {
                  // document.getElementById('btn2').addEventListener("click", () => {
                  //   console.log(this); //New
                  // })
                }
              }

              // let object3 = new New2();
              // object3.attach();
    </script>
</body>
</html>